\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{XTUthesis}[2018/02/14 XTU Master Thesis Package]

\RequirePackage{amsmath}
\RequirePackage{latexsym}
\RequirePackage{amsfonts}
\RequirePackage{amssymb}
\RequirePackage{mathrsfs}
\RequirePackage{bm}
\RequirePackage{graphicx}
\RequirePackage{color,xcolor}
\RequirePackage[CJKbookmarks,hyperindex=true,
            bookmarksnumbered=false,bookmarksopen=true,
            colorlinks,linkcolor=black,anchorcolor=black,citecolor=black]{hyperref}
\RequirePackage[paperwidth=21cm,paperheight=29.7cm,
            top=2.79cm,bottom=2.54cm,left=2.96cm,right=2.76cm,
            headheight=1.2cm,headsep=0.07cm,footskip=1.27cm]{geometry}
\RequirePackage{amscd}
\RequirePackage[linesnumbered,ruled,vlined]{algorithm2e}
\RequirePackage{slashbox}
\RequirePackage{cite}

\LoadClass[CJK,GBK,UTF8,12pt,oneside,a4paper]{ctexbook}

%---定制目录--------------------------------------------------------------------------
\makeatletter
\def\@bfdottedtocline#1#2#3#4#5{%
 \ifnum #1>\c@tocdepth \else
   \vskip \z@ \@plus.2\p@
   {\leftskip #2\relax \rightskip \@tocrmarg \parfillskip -\rightskip
    \parindent #2\relax\@afterindenttrue
    \interlinepenalty\@M
    \leavevmode \bfseries
    \@tempdima #3\relax
    \advance\leftskip \@tempdima \null\nobreak\hskip -\leftskip
    {#4}\normalfont\nobreak
    \leaders\hbox{$\m@th
       \mkern \@dotsep mu\hbox{.}\mkern \@dotsep
       mu$}\hfill
    \nobreak
    \hb@xt@\@pnumwidth{\hfil\normalfont \normalcolor #5}%
    \par}%
 \fi}
\renewcommand*\l@chapter{\@bfdottedtocline{0}{0em}{1.5em}}
\makeatother

%---定理, 定义 等环境的设置---------------------------------------------------------------
\newtheorem{definition}{\hspace{2em}定义}[section]
\newtheorem{proposition}{\hspace{2em}命题}[section]
\newtheorem{property}{\hspace{2em}性质}[section]
\newtheorem{lemma}{\hspace{2em}引理}[section]
\newtheorem{theorem}{\hspace{2em}定理}[section]
\newtheorem{corollary}{\hspace{2em}推论}[section]
\newtheorem{example}{\hspace{2em}例}
\newtheorem{remark}{\hspace{2em}注}

%---自定义命令和环境-----------------------------------------------------------------------
\newenvironment{cnabstract}[1]{%
    \chapter*{摘~~~~要}
    \songti\zihao{-4}#1%
    \vskip 0.2cm}

\newenvironment{cnkeywords}[1]{%
    \noindent{\heiti 关键词：}#1%
}

\newenvironment{enabstract}[1]{%
    \chapter*{\setmainfont{Arial}\bf Abstract}#1%
    \vskip 0.2cm
}

\newenvironment{enkeywords}[1]{%
    \noindent{\bf Key Words: }#1%
}

\CTEXsetup[format={\centering\sffamily}]{chapter}
\CTEXsetup[nameformat={\heiti\zihao{3}}]{chapter}
\CTEXsetup[titleformat={\heiti\zihao{3}}]{chapter}
\CTEXsetup[numberformat={\heiti\zihao{3}}]{chapter}
\CTEXsetup[beforeskip={0pt},afterskip={30pt}]{chapter}
\CTEXsetup[name={第, 章},number={\arabic{chapter}}]{chapter}

\CTEXsetup[format={\flushleft\sffamily\heiti\zihao{4}}]{section}
\CTEXsetup[beforeskip={24pt},afterskip={6pt}]{section}

\CTEXsetup[format={\flushleft\sffamily\heiti\zihao{-4}}]{subsection}
\CTEXsetup[beforeskip={12pt},afterskip={6pt}]{subsection}

\CTEXsetup[format={\flushleft\sffamily\heiti\zihao{-4}}]{subsubsection}
\CTEXsetup[beforeskip={12pt},afterskip={6pt}]{subsubsection}

\newlength\oneimage
\setlength\oneimage{0.8\textwidth}

\newlength\twoimage
\setlength\twoimage{0.45\textwidth}

\newlength\threeimage
\setlength\threeimage{0.3\textwidth}

%---罗马数字--------
\makeatletter
\newcommand*{\rom}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother

%---将Algorithm改为中文宋体“算法”--------
\renewcommand{\algorithmcfname}{\songti 算法}
\makeatletter
\renewcommand{\algocf@captiontext}[2]{#1\algocf@typo\quad \AlCapFnt{}#2}
\makeatother